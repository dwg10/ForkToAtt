<!-- INFOGRAPHICS PAGE -->

<!-- LINK TO CSS & JS-->
<link rel="stylesheet" href="{% static 'global/styling10.css' %}">
<link rel="stylesheet" href="{% static 'global/FriendlyChecks.css' %}">

<!-- Link to JS -->
<script src="{% static 'global/VT_functionality.js' %}"></script>
<script src="{% static 'global/FriendlyChecks.js' %}"></script>

<!-- Set viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- oTree templates -->
{% load otree static %}
{% block content %}

<body>

    <!-- Slide container-->
    <div class="flex-container">

        <!-- Title -->
        <h1> Infographics </h1>

        <!-- Slide 1 -->
        <div class="mySlides">
            <div class="slide-item">      
                <!-- Slide title -->
                <p class= "info-title"> Next, you are going to receive some extra information on the quality and sustainability labels </p>
        
                <!-- Slide text -->
                <p> Please read the following inforgraphics carefully through and make sure you understand the relationship between: </p>

                <ol>
                    <li> amount of leaves and planting trees (RANDOMIZE ORDER)</li>
                    <li> amount of stars & pounds (RANDOMIZE ORDER)</li>
                </ol>
            </div>
        </div>

        <!-- Slide 2-->
        <div class="mySlides">
            <div class="slide-item slide-item2">
                <!-- Slide title -->
                <p class="info-title"> Quality label explained </p>
                <div class="double-container">
                    <div class="img-container-info">
                        <img class="img-info" src="{% static test_graph %}" />
                    </div>
                    <div class="text-info">
                        (RANDOMIZE ORDER TEXT + IMAGE)
                        <p>Products with a Star label can earn you money. The graph shows how many pounds will be granted based on how many stars
                        the product has.</p>

                        <p>Product with 1 star grants between 0 - 2 pounds, product with 2 stars grants between 2 - 4 pounds, and product with 3
                        stars grants between 4 - 6 pounds.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3 -->
        <div class="mySlides">
            <div class="slide-item slide-item2">
                <!-- Slide title -->
                <p class="info-title"> Sustainability label explained: </p>
                <div class="double-container">
                    <div class="img-container-info">
                        <img class="img-info" src="{% static test_graph %}" />
                    </div>
                    <div class="text-info">
                        (RANDOMIZE ORDER TEXT + IMAGE)
                        <p>When you purchase a product with a Leaf label, you will help to plant trees in deforested areas! The graph shows how
                        many trees will be planted depending on how many leaves the product has.</p>
        
                        <p>Product with 1 leaf plants between 0 - 2 trees, product with 2 leaves plants between 2 - 4 trees, and product with three
                        leaves plants between 4 - 6 trees.</p>
                    </div>
                </div>
            </div>
        </div>


        <!-- Slide 4 (Questions) -->
        <div class="mySlides">
            <!-- Question slide container-->
            <div class="flex-questions flex-questions2">
                <p class="info-title"> Is it all clear? Please answer these questions correctly to proceed:</p>
                <li>
                    <!--Question 1-->
                    <div class="inst-question">
                        <!-- Question-->
                        <label for="Q1"> If you get a product with 3 leaves (symbol), what is the maximum amount of trees that can be planted?</label>
                    </div>
                    <div class="answer-field">
                        <!-- Input field -->
                        <input type="text" name="Q1" id="Q1" style="width: 9vw; height: 6vh">
                    </div>
                    <div class="hint" id="hint1">
                        <!-- Hint -->
                        Incorrect: see slide 3!
                        <div>
                </li>
                <li>
                    <!--Question 2-->
                    <div class="inst-question">
                        <label for="Q2"> If you get a product with 2 stars, what is the minimum amount of points you can get?</label>
                    </div>
                    <div class="answer-field">
                        <input type="text" name="Q2" id="Q2" style="width: 9vw; height: 6vh">
                    </div>
                    <div class="hint" id="hint2">
                        Incorrect: see slide 2!
                        <div>
                </li>
                <li>
                    <!-- Submit answers and Next button (next button appears when user answers all questions correctly)-->
                    <a id="submitAnswer" class="button" onclick=validateAnswers()>Submit
                    </a>
                    <button id="submit" class="button glow-button">Next</button>
                </li>
            </div>
        </div>

        <!-- Next and previous buttons -->
        <a id="leftArrow" class="prev" onclick="plusSlides(-1)">&#10094;</a>
        <p id="prevKey" class="prev-key"> <b>or press [&#8592;]</b> </p>

        <a id="rightArrow" class="next" onclick="plusSlides(1)">&#10095;</a>
        <p id="nextKey" class="next-key"> <b>or press [&#8594;] </b></p>

        <!-- The dots/circles (if you want to add extra slides, add span(s) here)-->
        <div class="dot_row">
            <span class="dot" onclick="currentSlide(1)"></span>
            <span class="dot" onclick="currentSlide(2)"></span>
            <span class="dot" onclick="currentSlide(3)"></span>
            <span class="dot" onclick="currentSlide(4)"></span>
        </div>

    </div>

</body>

<!-- oTree templates -->

{% endblock %}

<script>

    // Initialize slide index //
    let slideIndex = 1;
    showSlides(slideIndex);


    // Next/previous controls: activate showSlides functions if arrows and arrow keys pressed. Stops the slides from going in "carousel" + slide 5 & 6 enabled after hovering a button on slide 4. 
    function plusSlides(n) {
        if (n === (-1) && slideIndex === 1) {
            return;
        } else if (n === 1 && slideIndex === 4) {
            return;
        } else {
        showSlides(slideIndex += n);
        }
    };

    // Thumbnail image controls (slide 5 & 6 enabled after hovering a button on slide 4)
    function currentSlide(n) {
        showSlides(slideIndex = n);
    };

    // Next/previous keypress controls //

    document.addEventListener('keydown', (event) => {
        let keypress = event.key;
        if (keypress === 'ArrowLeft') {
            plusSlides(-1);
            ArrowText();
        } else if (keypress === 'ArrowRight') {
            plusSlides(1);
            ArrowText();
        }
    });

    // Hide text under arrows when user clicks left or right arrow button
    function ArrowText() {
        document.getElementById("nextKey").style.visibility = "hidden"
        document.getElementById("prevKey").style.visibility = "hidden";
    };

    // Slide switch function //
    function showSlides(n) {
        let i; // slide count
        let slides = document.getElementsByClassName("mySlides"); // get slides
        let dots = document.getElementsByClassName("dot"); // get dots
        let arrowLeft = document.querySelector("#leftArrow"); // get left arrow
        let arrowRight = document.querySelector("#rightArrow"); // get right arrow

        for (i = 0; i < slides.length; i++) { // hide slides by default
            slides[i].style.display = "none";
        }
        for (i = 0; i < dots.length; i++) { // change dot color based on dot count
            dots[i].className = dots[i].className.replace(" active", "");
        }
        slides[slideIndex - 1].style.display = "block"; // show slide
        dots[slideIndex - 1].className += " active"; // change dot color 

        if (n === 1) {
            arrowLeft.style.display = "none" // make left arrow invisible on 1st slide
        } else if (n > 1) {
            arrowLeft.style.display = "block"
        }

        if (n >= slides.length) {
            arrowRight.style.display = "none" // make right arrow invisible on last slide
        } else if (n < slides.length) {
            arrowRight.style.display = "block"
        }

        if (n === 1) { // make arrow text visible/invisible based on slide count
            document.getElementById("prevKey").style.display = "none";
        } else {
            document.getElementById("prevKey").style.display = "block";
        };
        if (n === slides.length) {
            document.getElementById("nextKey").style.display = "none";
        } else {
            document.getElementById("nextKey").style.display = "block";
        };

    }

    // QUESTIONS SLIDE //

    // This function runs when "Submit" button is clicked. It compares all the inputs to question with solutions; if input is incorrect or empty, hint appears next to it. If the answer is correct, the function makes hint invisible again. If all inputs are correct, "Next" button will become visible. 

    let submitButton = document.getElementById("submitAnswer"); // get submit button
    let nextButton = document.getElementById("submit"); // get Next button

    nextButton.style.display = "none" // Hide Next button

    function validateAnswers() {

        let solutions = ['6', '3']; // solutions
        let hints = document.getElementsByClassName("hint"); // make array of hints

        // get answer fields
        let A1 = document.getElementById("Q1");
        let A2 = document.getElementById("Q2");

        let answerList = [A1, A2]; // create an array out of the answers
        let correct = 0; // initialize counter for correct answers

        for (i = 0; i < answerList.length; i++) { // iterate through answers
            if (answerList[i] !== null) { // check for empty fields
                answerList[i] = answerList[i].value; // get value if not empty
            }
            if (answerList[i] !== solutions[i] || answerList[i] === null) { // incorrect or empty field: show hint
                hints[i].style.visibility = "visible";
            } else {
                correct = correct + 1; // correct: increase counter, hide hint
                hints[i].style.visibility = "hidden";

            }
        }
        if (correct === answerList.length) { // if all correct, hide Submit button and show Next button
            submitButton.style.display = "none"
            nextButton.style.display = "block"
        }

    }

</script>